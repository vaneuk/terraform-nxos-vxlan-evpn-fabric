interfaces_ethernet:
  {%- for id in underlay_interfaces %}
  - id: {{id}}
    description: underlay interface
    layer3: true
    link_debounce_down: 0
    mtu: 9216
    ipv4_address: {{ip[id]}}/31
  {% endfor %}
interfaces_loopback:
  "0":
    description: Router ID
    ipv4_address: {{ip.lo0}}/32
interface_nve:
  admin_state: true
  hold_down_time: 300
  host_reachability_protocol: bgp
  ingress_replication_protocol_bgp: true
  source_interface: "lo0"
  # VNI List is populated automatically based on services applied to leaf
features:
  pim: false
ospf:
  underlay:
    vrfs:
      default:
        router_id: {{ip.lo0}}
        adjancency_logging_level: detail
        bandwidth_reference: 1000
        banwidth_reference_unit: gbps
        interfaces:
          lo0:
            area: 0.0.0.0
        # ethernet interfaces are added dynamically
        {%- for id in underlay_interfaces %}
          eth{{id}}:
            area: 0.0.0.0
            network_type: p2p
        {% endfor %}
bgp:
  asn: {{bgp.asn}}
  enhanced_error: false
  template_peers:
    SPINE-PEERS:
      asn: {{bgp.asn}}
      source_interface: lo0
      address_families:
        l2vpn_evpn:
          send_community_standard: true
          send_community_extended: true
  vrfs:
    default:
      router_id: {{ip.lo0}}
      log_neighbor_changes: true
      graseful_restart_stalepath_time: 1800
      graseful_restart_restart_time: 300
      neighbors:
      # spine peers are added automatically
      {%- for peer in bgp.spine_peers %}
        {{peer.ip}}:
          inherit_peer: SPINE-PEERS
          description: {{peer.name}}
      {% endfor %}
vrfs:
  - name: default